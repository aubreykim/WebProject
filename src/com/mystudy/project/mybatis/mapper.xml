<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="project">

<select id="selectCategoryNo" parameterType="string" resultType="String">
	SELECT CATEGORY_NO
	FROM CATEGORY
	WHERE CATEGORY_NAME = #{category}
</select>

<select id="selectTotalCount" parameterType="int" resultType="int">
	SELECT COUNT(*) 
	FROM PRODUCT
	WHERE CATEGORY_NO = #{categoryNo}
</select>

<select id="selectListNew" parameterType="map" resultType="com.mystudy.project.vo.ProductVO">
	SELECT *
	FROM ( SELECT ROWNUM R_NUM, P.*
	       FROM (SELECT * FROM PRODUCT ORDER BY PRODUCT_NO DESC ) P
	      )
	WHERE CATEGORY_NO = #{categoryNo}
	AND R_NUM BETWEEN #{begin} AND #{end}
</select>

<select id="selectListPrice" parameterType="map" resultType="com.mystudy.project.vo.ProductVO">
	SELECT *
	FROM ( SELECT ROWNUM R_NUM, P.*
	       FROM (SELECT * FROM PRODUCT ORDER BY PRICE ) P
	      )
	WHERE CATEGORY_NO = #{categoryNo}
	AND R_NUM BETWEEN #{begin} AND #{end}
</select>

<select id="selectListName" parameterType="map" resultType="com.mystudy.project.vo.ProductVO">
	SELECT *
	FROM ( SELECT ROWNUM R_NUM, P.*
	       FROM (SELECT * FROM PRODUCT ORDER BY PRODUCT_NAME ) P
	      )
	WHERE CATEGORY_NO = #{categoryNo}
	AND R_NUM BETWEEN #{begin} AND #{end}
</select>


<select id="selectProductVO" parameterType="string" resultType="com.mystudy.project.vo.ProductVO">
	SELECT *
	FROM PRODUCT
	WHERE PRODUCT_NO = #{productNo}
</select>


<select id="selectProductOption" parameterType="string" resultType="com.mystudy.project.vo.SizeVO">
	SELECT *
	FROM PRODUCT_OPTION
	WHERE PRODUCT_NO = #{productNo}
</select>


<select id="selectReview" parameterType = "map" resultType="com.mystudy.project.vo.ReviewVO">
	SELECT *
	FROM ( SELECT ROWNUM R_NUM, R.*
	       FROM (SELECT * FROM REVIEW 
	       		WHERE PRODUCT_NO = #{productNo} 
	       		ORDER BY REVIEW_NO DESC
	       		) R
	     )
	WHERE R_NUM BETWEEN #{begin} AND #{end}
</select>



<select id="selectOptionNo" parameterType="map" resultType="string">
	SELECT OPTION_NO
	FROM PRODUCT_OPTION
	WHERE PRODUCT_NO = #{productNo}
	AND OPTION_SIZE = #{productOption}
</select>

<insert id="insertCart" parameterType="map">
	INSERT INTO CART
        	(CART_NO, OPTION_NO, USER_ID, QTY)
	VALUES  (CART_NO_SEQ.NEXTVAL, #{optionNo}, #{userId}, #{qty})
</insert>

<insert id="inserLikeProduct" parameterType="map">
	INSERT INTO LIKE_PRODUCT
        	(LIKE_NO, PRODUCT_NO, USER_ID, LDATE)
	VALUES (LIKE_NO_SEQ.NEXTVAL, #{productNo}, #{userId}, SYSDATE)
</insert>


</mapper>
